
@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_layout.cshtml";
}

@model CommonViewModel
@using Motel.ViewModels
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@addTagHelper *, YourProjetcName


<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">
                <span class="caption-subject font-green sbold uppercase">Phân quyền người dùng</span>
                <div class="card-tools">
                    <button type="button" class="btn btn-tool" data-card-widget="collapse">
                        <i class="fas fa-minus"></i>
                    </button>

                    <div class="btn-group">
                        <button type="button" class="btn btn-tool dropdown-toggle" data-toggle="dropdown">
                            <i class="fas fa-wrench"></i>
                        </button>
                        <div class="dropdown-menu dropdown-menu-right" role="menu">
                            <a href="#" class="dropdown-item">Action</a>
                            <a href="#" class="dropdown-item">Another action</a>
                            <a href="#" class="dropdown-item">Something else here</a>
                            <a class="dropdown-divider"></a>
                            <a href="#" class="dropdown-item">Separated link</a>
                        </div>
                    </div>
                </div>
            </div>


            <!-- /.card-header -->
            <div class="card-body">

                <div class="text-left" style="padding-top:20px;">
                    <div class="row">
                        <div class="col-md-2">
                            <label class="control-label">Chọn nhóm người dùng</label>
                        </div>
                        <div class="col-md-6">

                            <select class="form-control select2-hidden-accessible"
                                    asp-for="qlPhanQuyenViewModel.MaNhomNguoiDung"
                                    id="cbb_nhomnguoidung" tabindex="-1" aria-hidden="true">
                                @{
                                    <option value="0">
                                        ----
                                    </option>
                                    foreach (var item in Model.qlPhanQuyenViewModel.listNhomNguoiDung)
                                    {
                                        <option value="@item.MaNhomNguoiDung">
                                            @item.TenNhomNguoiDung
                                        </option>
                                    }
                                }
                            </select>

                        </div>

                    </div>

                </div>

                <div id="table_phong">
                    @await Html.PartialAsync("Table", Model)
                </div>

                <div class="row">
                    <div class="card-tools">
                        <ul class="pagination pagination-sm">
                            <li class="page-item"><a href="#" class="page-link">&laquo;</a></li>
                            <li class="page-item"><a href="#" class="page-link">1</a></li>
                            <li class="page-item"><a href="#" class="page-link">2</a></li>
                            <li class="page-item"><a href="#" class="page-link">3</a></li>
                            <li class="page-item"><a href="#" class="page-link">&raquo;</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <!-- /.col -->
    </div>
</div>

<script src="~/Form/jsController/popper-min.js"></script>
<script src="~/Form/jsController/jquery.js"></script>
<script src="~/Form/jsController/popper-min.js"></script>
<script src="~/Form/jsController/bootstrap-confirmation-min.js"></script>
<script src="~/Form/plugins/layout/layout-min.js"></script>
<script src="~/Form/plugins/bootstrap-confirmation-min.js"></script>
<script src="~/Form/plugins/bootstrap-fileinput.js"></script>
<script src="~/Form/plugins/bootstrap-hover-dropdown-min.js"></script>
<script src="~/Form/plugins/js-cookie-min.js"></script>
<script src="~/Form/plugins/tableHeadFixer.js"></script>
<script src="~/Form/plugins/tinymce-min.js"></script>
<script src="~/Form/plugins/toastr-min.js"></script>
<script src="~/Form/plugins/ui-toastr-min.js"></script>
<link href="~/Form/css/blog-min.css" rel="stylesheet" />
<link href="~/Form/css/component-md-min.css" rel="stylesheet" />
<link href="~/Form/css/custom-green.css" rel="stylesheet" />
<link href="~/Form/css/layout-min.css" rel="stylesheet" />
<link href="~/Form/css/plugins-md-min.css" rel="stylesheet" />
<link href="~/Form/css/pricing-min.css" rel="stylesheet" />
<link href="~/Form/css/search-min.css" rel="stylesheet" />
<script src="~/Form/plugins/layout/bootstrap-min.js"></script>

<script type="text/javascript">
    $(document).ready(function () {
        $('#cbb_nhomnguoidung').change(function () {
            $.ajax({
                type: "GET",
                url: '/PhanQuyen/Table',
                dataType: 'script',
                data: {
                    idNhomNguoiDung: $('#cbb_nhomnguoidung').val(),
                },
                success: function (res) {
                    $("#table_phong").html(res);
                }

            });
        });

        $('table.items-table-service').on('click', '.add-selection-service, .remove-selection-service', function () {
            /* "this" is the button element instance */
            var $btn = $(this).toggleClass('add-selection-service remove-selection-service'),
                /* define row to be moved by looking up DOM tree*/
                $item = $btn.closest('tr'),
                /* define other table */
                $otherTable = $('.items-table-service').not($btn.closest('table'));

            $btn.find('span').toggleClass('fa fa-plus fa fa-minus');
            $btn.find('input:checkbox').prop("checked", !$btn.find('input:checkbox').is(":checked"));

            /*Cập nhật uncheck cho checkbox*/
            var $id = $btn.find('input:checkbox').val();
            $item.find('#checkboxstatus' + $id).attr("checked", false);

            if ($(this).hasClass("remove-selection-service")) {
                $("." + $id).removeClass("hide");
                $(".unit-price-" + $id).addClass("hide");
            } else {
                $("." + $id).addClass("hide");
                $(".unit-price-" + $id).removeClass("hide");
            }
            ;

            $otherTable.append($item);
        });

        // Remove Or Add all
        $('table.items-table-service').on('click', '.add-all-selection-service, .remove-all-selection-service', function () {

            // Lấy thông tin bảng được chọn dựa trên phần tử được click
            $myTable = $(this).closest('table');
            $rowsMyTable = $myTable.find('> tbody > tr');
            $otherTable = $('.items-table-service').not($(this).closest('table'));

            $rowsMyTable.each(function () {
                $item1x = $(this).find('.item-selection-service');
                if ($item1x.length > 0) {
                    var columns = $(this).find('td');
                    columns.each(function () {
                        $btnSelection = $(this).find('.item-selection-service');
                        $btn = $btnSelection.toggleClass('add-selection-service remove-selection-service');
                        $btn.find('span').toggleClass('fa fa-plus fa fa-minus');
                        $btn.find('input:checkbox').prop("checked", !$btn.find('input:checkbox').is(":checked"));

                        /*Cập nhật uncheck cho checkbox*/
                        var $id = $btn.find('input:checkbox').val();
                        $item = $(this).closest('tr');
                        $item.find('#checkboxstatus' + $id).attr("checked", false);

                        if ($btn.hasClass("remove-selection-service")) {
                            $("." + $id).removeClass("hide");
                            $(".unit-price-" + $id).addClass("hide");
                        } else {
                            $("." + $id).addClass("hide");
                            $(".unit-price-" + $id).removeClass("hide");
                            $(".unit-price-" + $id).removeClass("hide");
                        }
                        ;
                    });
                    $otherTable.append($(this));
                }
            });
        });
    });

</script>



