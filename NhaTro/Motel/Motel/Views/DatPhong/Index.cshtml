@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_layout.cshtml";
}
@using Motel.ViewModels
@model QuanLyDatPhongViewModel
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@addTagHelper *, YourProjetcName
@{
    if (ViewData["Title"] != null)
    {
        <script type="text/javascript">
            toastr.error("", "Email or password is wrong !)");
        </script>
    }
}


<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">
                <span class="caption-subject font-green sbold uppercase">Quản lý đặt phòng</span>
                <div class="card-tools">
                    <button type="button" class="btn btn-tool" data-card-widget="collapse">
                        <i class="fas fa-minus"></i>
                    </button>

                    <div class="btn-group">
                        <button type="button" class="btn btn-tool dropdown-toggle" data-toggle="dropdown">
                            <i class="fas fa-wrench"></i>
                        </button>
                        <div class="dropdown-menu dropdown-menu-right" role="menu">
                            <a href="#" class="dropdown-item">Action</a>
                            <a href="#" class="dropdown-item">Another action</a>
                            <a href="#" class="dropdown-item">Something else here</a>
                            <a class="dropdown-divider"></a>
                            <a href="#" class="dropdown-item">Separated link</a>
                        </div>
                    </div>
                </div>
            </div>
            <!-- /.card-header -->
            <div class="card-body">
                <div class="text-right">
                    <button id="myBtn" data-target="#myModal" data-toggle="modal" type="button" class="btn green btn-outline btn-circle btn-sm tooltips" data-original-title="Thêm mới"><i class="fa fa-plus"></i> Thêm mới</button>
                    <a class="btn green btn-outline btn-circle btn-sm tooltips" data-original-title="Tìm kiếm" data-placement="top" data-remote="true" href="#"><i class="fa fa-search"></i>Tìm kiếm</a>
                    <button data-toggle="confirmation" data-placement="left" type="submit" form="myForm"
                            class="btn green btn-outline btn-circle btn-sm"
                            data-template="<div class=&quot;popover confirmation&quot;><div class=&quot;arrow&quot;></div><h3 class=&quot;popover-title&quot;></h3><div class=&quot;popover-content text-center&quot;><div class=&quot;btn-group&quot;><a class=&quot;btn&quot; data-apply=&quot;confirmation&quot;></a><a class=&quot;btn&quot; data-dismiss=&quot;confirmation&quot;></a></div></div></div>"
                            data-original-title="" title="">
                        <i class="fa fa-trash font-red"></i>Xóa nhiều
                    </button>

                </div>
                <div class="row">
                    <div class="card-body">
                        <table class="table table-striped table-bordered table-hover">
                            <thead>
                                <tr>
                                    <th class="text-center">
                                    </th>
                                    <th>Phòng</th>
                                    <th>Người đặt cọc</th>
                                    <th>Số điện thoại</th>
                                    <th>Tiền đặt cọc</th>
                                    <th>Ngày đặt cọc</th>
                                    <th>Ngày hết hạn</th>
                                    <th></th>
                                </tr>
                            </thead>

                            <tbody>
                                @{

                                    foreach (var item in Model.listDatPhong)
                                    {
                                        <tr class="item-1932 highlight">
                                            <td class="text-center">
                                                <div class="btn-group">
                                                    <button class="btn btn-xs green dropdown-toggle" type="button"
                                                            data-toggle="dropdown" aria-expanded="false">
                                                        Tác vụ
                                                        <i class="fa fa-angle-down"></i>
                                                    </button>
                                                    <ul class="dropdown-menu" role="menu">
                                                        <li>
                                                            <a data-remote="true" href="#"><i class="icon-pencil"></i> Chỉnh sửa</a>
                                                        </li>
                                                        <li>
                                                            <a data-remote="true" href="#"><i class="fa fa-handshake-o" aria-hidden="true"></i> Tạo hợp đồng</a>
                                                        </li>
                                                        <li class="divider"></li>
                                                        <li>
                                                            <a href="#">
                                                                <i class="fa fa-file-word-o"></i> Giấy nhận cọc
                                                            </a>
                                                        </li>
                                                        
                                                    </ul>
                                                </div>
                                            </td>
                                            <td>@item.TenPhong</td>
                                            <td>@item.TenKhachHang</td>
                                            <td>@item.SoDienThoai</td>
                                            <td>@item.SoTienCoc</td>
                                            <td>@item.NgayDat</td>
                                            <td>@item.NgayHetHan</td>
                                            <td class="text-center">
                                                <a data-toggle="confirmation"
                                                   data-placement="left" 
                                                   id="btn_delete"
                                                   class="btn red btn-circle btn-icon-only btn-default"
                                                   data-remote="true" data-method="delete"> <i class="fas fa-trash"></i></a>
                                                <div class="popover confirmation fade left in" 
                                                     id="confirm1" style="top: 89px; left: 1241px;">
                                                    <div class="arrow" style="top: 50%;"></div>
                                                    <h3 class="popover-title">Bạn chắc chắn muốn xóa dữ liệu?</h3>
                                                    <div class="popover-content text-center">
                                                        <div class="btn-group">
                                                            <a class="btn btn-sm btn-success" data-apply="confirmation" data-remote="true" data-method="delete" href="">
                                                                <i class="glyphicon glyphicon-ok"></i> Có
                                                            </a>
                                                            <a class="btn btn-sm btn-danger" data-dismiss="confirmation">
                                                                <i class="glyphicon glyphicon-remove"></i> Không
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                            @*<td class="text-center">
                                                    <a data-btn-ok-class="btn-success"
                                                        data-btn-cancel-class="btn-danger"
                                                        data-toggle="confirmation"
                                                        data-placement="left" data-singleton="true"
                                                        id="btn_delete"
                                                        class="btn red btn-circle btn-icon-only btn-default cus-tooltips cus-confirmations"
                                                        data-remote="true" data-method="delete"> <i class="fas fa-trash"></i></a>
                                                    <div class="popover confirmation fade left in"
                                                            id="confirmation467264" style="top: 89px; left: 1241px; display: block;">
                                                        <div class="arrow" style="top: 50%;"></div>
                                                        <h3 class="popover-title">Bạn chắc chắn muốn xóa dữ liệu?</h3>
                                                        <div class="popover-content text-center">
                                                            <div class="btn-group">
                                                                <a class="btn btn-sm btn-success" data-apply="confirmation" data-remote="true" data-method="delete" href="">
                                                                    <i class="glyphicon glyphicon-ok"></i> Có
                                                                </a>
                                                                <a class="btn btn-sm btn-danger" data-dismiss="confirmation">
                                                                    <i class="glyphicon glyphicon-remove"></i> Không
                                                                </a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>*@
                                        </tr>
                                    }
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="row">
                    <div class="card-tools">
                        <ul class="pagination pagination-sm">
                            <li class="page-item"><a href="#" class="page-link">&laquo;</a></li>
                            <li class="page-item"><a href="#" class="page-link">1</a></li>
                            <li class="page-item"><a href="#" class="page-link">2</a></li>
                            <li class="page-item"><a href="#" class="page-link">3</a></li>
                            <li class="page-item"><a href="#" class="page-link">&raquo;</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <!-- /.col -->
    </div>
</div>

<div id="myModal" role="dialog" class="modal fade in" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <div class="caption font-green">
                    <span class="caption-subject bold uppercase">
                        <i class="fa fa-plus"></i> Thêm mới
                    </span>
                </div>
                <div class="actions">
                    <a class="btn btn-circle btn-icon-only btn-default show-main-modal" data-dismiss="modal" id="close">
                        <i class="fa fa-times"></i>
                    </a>
                </div>
            </div>
            <div class="modal-body">
                <form method="POST" asp-controller="DatPhong" asp-action="Create"
                      class="simple_form form-horizontal" novalidate="novalidate"
                      id="new_admin_building" accept-charset="UTF-8" data-remote="true">
                    <input name="utf8" type="hidden" value="✓">
                    <ul class="errors"></ul>
                    <div class="form-group form-md-line-input  row">
                        <div class="col-md-2"></div>
                        <label class="col-md-2 control-label">
                            Khách thuê
                            <span class="required" aria-required="true"> * </span>
                        </label>
                        <div class="col-md-6">
                            <div class="md-radio-inline">
                                <div class="md-radio">
                                    <input type="radio" id="radio_renter_status0" name="admin_deposit[type]" checked="" class="md-radiobtn" value="0">
                                    <label for="radio_renter_status0">
                                        <span></span>
                                        <span class="check"></span>
                                        <span class="box"></span>Thêm mới
                                    </label>
                                </div>
                                <div class="md-radio">
                                    <input type="radio" id="radio_renter_status1" name="admin_deposit[type]" class="md-radiobtn" value="1">
                                    <label for="radio_renter_status1">
                                        <span></span>
                                        <span class="check"></span>
                                        <span class="box"></span>Đã tồn tại
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2"></div>
                    </div>
                    <div class="form-group form-md-line-input row">
                        <label class="col-md-2 control-label">
                            Phòng
                            <span class="required" aria-required="true"> * </span>
                        </label>
                        <div class="col-md-4">
                            <select asp-for="khachHangDatPhong.datPhong._MaPH" class="text required bg-maxlength form-control"
                                    name="datPhong._MaPH"
                                    id="_MaPH" tabindex="-1" aria-hidden="true">
                                @{
                                    foreach (var item in Model.listPhong)
                                    {
                                        <option value="@item.MaPH">@item.Ten</option>
                                    }
                                }
                            </select>
                            <div class="form-control-focus"></div>
                        </div>
                        <label class="col-md-2 control-label">
                            Khách hàng
                            <span class="required" aria-required="true"> * </span>
                        </label>
                        <div class="col-md-4">
                            <select asp-for="khachHangDatPhong.datPhong._MaKH" hidden class="text required bg-maxlength form-control"
                                    name="datPhong._MaKH"
                                    id="Khachhang1" tabindex="-1" aria-hidden="true">
                                <option value="0">----</option>
                                @{
                                    foreach (var item in Model.listKhachHang)
                                    {
                                        <option value="@item.MaKh">@item.TenKH</option>
                                    }
                                }
                            </select>
                            <input class="string required bg-maxlength form-control"
                                   asp-for="khachHangDatPhong.khachHang.TenKH"
                                   placeholder="Tên Khach Hàng"
                                   name="khachHang.TenKH"
                                   maxlength="50" size="50" type="text"
                                   id="Khachhang">
                            <div class="form-control-focus"></div>
                        </div>
                    </div>
                    <div class="form-group form-md-line-input row">
                        <label class="col-md-2 control-label">
                            Số tiền cọc
                            <span class="required" aria-required="true"> * </span>
                        </label>
                        <div class="col-md-4">
                            <input class="string required bg-maxlength form-control"
                                   asp-for="khachHangDatPhong.datPhong.SoTienCoc"
                                   value="0" placeholder=" Số tiền cọc"
                                   name="datPhong.SoTienCoc"
                                   maxlength="50" size="50" type="text"
                                   id="SoTienCoc">
                            <div class="form-control-focus"></div>
                        </div>
                        <label class="col-md-2 control-label">CMND</label>
                        <div class="col-md-4">
                            <input class="string required bg-maxlength form-control"
                                   asp-for="khachHangDatPhong.khachHang.CMND"
                                   placeholder="CMND" maxlength="50"
                                   name="khachHang.CMND"
                                   size="50" type="text" id="cmnd">
                            <div class="form-control-focus"></div>
                        </div>
                    </div>
                    <div class="form-group form-md-line-input row">
                        <label class="col-md-2 control-label">
                            Ngày đặt
                            <span class="required" aria-required="true"> * </span>
                        </label>
                        <div class="col-md-4">
                            <input class="string required bg-maxlength form-control"
                                   placeholder="Tổng số phòng"
                                   asp-for="khachHangDatPhong.datPhong.NgayDat"
                                   name="datPhong.NgayDat"
                                   maxlength="50" size="50" type="date"
                                   id="NgayDat">
                            <div class="form-control-focus"></div>
                        </div>
                        <label class="col-md-2 control-label">Số điện thoại</label>
                        <div class="col-md-4">
                            <input class="string required bg-maxlength form-control"
                                   asp-for="khachHangDatPhong.khachHang.SoDienThoai"
                                   value="0" placeholder="Số điện thoại" maxlength="50"
                                   name="khachHang.SoDienThoai"
                                   size="50" type="text" id="sdt">
                            <div class="form-control-focus"></div>
                        </div>
                    </div>
                    <div class="form-group form-md-line-input row">
                        <label class="col-md-2 control-label">
                            Ngày hết hạn
                            <span class="required" aria-required="true"> * </span>
                        </label>
                        <div class="col-md-4">
                            <input class="string required bg-maxlength form-control"
                                   asp-for="khachHangDatPhong.datPhong.NgayHetHan"
                                   placeholder="Ngày hết hạn"
                                   name="datPhong.NgayHetHan"
                                   maxlength="50" size="50" type="date"
                                   id="NgayHetHan">
                            <div class="form-control-focus"></div>
                        </div>
                        <label class="col-md-2 control-label">Ngày sinh</label>
                        <div class="col-md-4">
                            <input class="string required bg-maxlength form-control"
                                   placeholder="Ngày sinh"
                                   asp-for="khachHangDatPhong.khachHang.NgaySinh"
                                   name="khachHang.NgaySinh"
                                   maxlength="50" size="50" type="date"
                                   id="ngaysinh">
                            <div class="form-control-focus"></div>
                        </div>
                    </div>
                    <div class="form-group form-md-line-input row">
                        <label class="col-md-2 control-label">Mô tả</label>
                        <div class="col-md-4">
                            <textarea class="text optional bg-maxlength form-control autosizeme"
                                      asp-for="khachHangDatPhong.datPhong.GhiChu"
                                      name="datPhong.GhiChu"
                                      placeholder="Nhập mô tả" maxlength="500"
                                      id="Mota"></textarea>
                            <div class="form-control-focus"></div>
                        </div>
                        <label class="col-md-2 control-label">Email</label>
                        <div class="col-md-4">
                            <input class="text optional bg-maxlength form-control autosizeme"
                                   asp-for="khachHangDatPhong.khachHang.Mail"
                                   type="text" name="khachHang.Mail"
                                   placeholder="Email" maxlength="500"
                                   id="email" />
                            <div class="form-control-focus"></div>
                        </div>
                    </div>
                    <div class="form-actions margin-top-10">
                        <div class="row">
                            <div class="col-md-12 text-right">
                                <button type="button" class="btn btn-default" data-dismiss="modal">
                                    <i class="fa fa-arrow-circle-o-left" aria-hidden="true"></i>Hủy bỏ


                                </button>
                                <button name="button" type="submit" class="btn btn-default btnFormSubmit btn green">
                                    <i class="fa fa-floppy-o" aria-hidden="true"></i>  Lưu lại
                                </button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script src="~/Form/jsController/popper-min.js"></script>
<script src="~/Form/jsController/jquery.js"></script>
<script src="~/Form/jsController/popper-min.js"></script>
<script src="~/Form/jsController/bootstrap-confirmation-min.js"></script>
<script src="~/Form/plugins/layout/layout-min.js"></script>
<script src="~/Form/plugins/bootstrap-confirmation-min.js"></script>
<script src="~/Form/plugins/bootstrap-fileinput.js"></script>
<script src="~/Form/plugins/bootstrap-hover-dropdown-min.js"></script>
<script src="~/Form/plugins/js-cookie-min.js"></script>
<script src="~/Form/plugins/tableHeadFixer.js"></script>
<script src="~/Form/plugins/tinymce-min.js"></script>
<script src="~/Form/plugins/toastr-min.js"></script>
<script src="~/Form/plugins/ui-toastr-min.js"></script>
<link href="~/Form/css/blog-min.css" rel="stylesheet" />
<link href="~/Form/css/component-md-min.css" rel="stylesheet" />
<link href="~/Form/css/custom-green.css" rel="stylesheet" />
<link href="~/Form/css/layout-min.css" rel="stylesheet" />
<link href="~/Form/css/plugins-md-min.css" rel="stylesheet" />
<link href="~/Form/css/pricing-min.css" rel="stylesheet" />
<link href="~/Form/css/search-min.css" rel="stylesheet" />
<script src="~/Form/plugins/layout/bootstrap-min.js"></script>


<script>

    $(document).ready(function () {
        $('#radio_renter_status1').click(function () {
            $('#Khachhang').prop('hidden', true);
            $('#Khachhang1').prop('hidden', false);
            $("#cmnd").prop('disabled', true);
            $("#sdt").prop('disabled', true);
            $("#email").prop('disabled', true);
            $("#ngaysinh").prop('disabled', true);
        })
        $('#radio_renter_status0').click(function () {
            $('#Khachhang').prop('hidden', false);
            $('#Khachhang1').prop('hidden', true);
            $("#cmnd").prop('disabled', false);
            $("#sdt").prop('disabled', false);
            $("#email").prop('disabled', false);
            $("#ngaysinh").prop('disabled', false);
        })
        $("#NgayDat").change(function () {
            var start_date = convert_to_date($("#NgayDat").val());
            var end_date = convert_to_date($("#NgayHetHan").val());
            if (start_date > end_date) {
                toastr.error('Ngày đặt cọc phải nhỏ hơn ngày hết hạn')
                $(".errors").text(toastr);
            }
        });

        $("#NgayHetHan").change(function () {
            var start_date = convert_to_date($("#NgayDat").val());
            var end_date = convert_to_date($("#NgayHetHan").val());

            if (end_date < start_date) {
                toastr.error('Ngày hết hạn phải lớn hơn ngày đặt cọc');
                $(".errors").text(toastr);

            }
        });
        $('[data-toggle="popover"]').popover();
        $('#btn_delete').confirmation({

                placement       :'right',
                title           :'Are you sure?',
                btnOkClass      :'btn btn-sm btn-danger',
                btnOkLabel      :'Delete',
                btnOkIcon       :'glyphicon glyphicon-ok',
                btnCancelClass  :'btn btn-sm btn-default',
                btnCancelLabel  :'Cancel',
                btnCancelIcon   :'glyphicon glyphicon-remove',
                href            :'#',
                target          :'_self',
                singleton       :true,
                popout          :true,
                onShow          :function(event, element) {},
                onHide          :function(event, element) {},
                onConfirm       :function(event, element) {},
                onCancel        :function(event, element) {},
                template        :  '<div class="popover"><div class="arrow"></div>'
                                  +'<h3 class="popover-title"></h3>'
                                  +'<div class="popover-content">'
                                  +' <a data-apply="confirmation">Yes</a>'
                                  +' <a data-dismiss="confirmation">No</a>'
                                  +'</div>'
                                  +'</div>'

              });


    });
</script>



