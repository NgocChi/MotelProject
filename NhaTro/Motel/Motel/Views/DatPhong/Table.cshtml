
@{
    Layout = null;
}
@using Motel.ViewModels
@model QuanLyDatPhongViewModel
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@addTagHelper *, YourProjetcName


<div class="row">
    <div class="card-body">
        <table class="table table-striped table-bordered table-hover">
            <thead>
                <tr>
                    <th class="text-center">
                    </th>
                    <th>Phòng</th>
                    <th>Người đặt cọc</th>
                    <th>Số điện thoại</th>
                    <th>Tiền đặt cọc</th>
                    <th>Ngày đặt cọc</th>
                    <th>Ngày hết hạn</th>
                    <th></th>
                </tr>
            </thead>

            <tbody>
                @{

                    foreach (var item in Model.listDatPhong)
                    {

                        @if (item.NgayHetHan < DateTime.Now.AddDays(3) && item.NgayHetHan > DateTime.Now)
                        {
                            <tr class="item-1932 highlight" style="background-color:gold;">
                                <td class="text-center">
                                    <div class="btn-group">
                                        <button class="btn btn-xs green dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false">
                                            Tác vụ
                                            <i class="fa fa-angle-down"></i>
                                        </button>
                                        <div class="dropdown">
                                            <ul class="dropdown-menu">
                                                <li>
                                                    <a href="#" onclick="ShowPopup('@Url.Action("AddOrEdit","DatPhong",new { id = item.MaDP }, Context.Request.Scheme)','Chỉnh sửa')"><i class="fas fa-edit"></i> Chỉnh sửa</a>
                                                </li>
                                                <li>
                                                    <a href="#" onclick="ShowPopupLarge('@Url.Action("AddOrEdit","HopDong",new { id = 0, idDatPhong = item.MaDP }, Context.Request.Scheme)','Nhận phòng')"><i class="fas fa-handshake-o" aria-hidden="true"></i>Nhận phòng</a>
                                                </li>
                                                <li class="divider"></li>
                                                <li>
                                                    <a asp-controller="DatPhong" asp-action="ExportPDF" asp-route-id="@item.MaDP"><i class="fas fa-handshake-o" aria-hidden="true"></i>Giay nhận cọc</a>
                                                </li>
                                            </ul>
                                        </div>

                                    </div>
                                </td>
                                <td>@item.TenPhong</td>
                                <td>@item.TenKhachHang</td>
                                <td>@item.SoDienThoai</td>
                                <td>@item.SoTienCoc</td>
                                <td>@item.NgayDat</td>
                                <td>@item.NgayHetHan</td>
                                <td class="text-center">
                                    <form asp-action="Delete"
                                          asp-route-id="@item.MaDP"
                                          onsubmit="return jQueryAjaxDelete(this)">
                                        <button type="submit"
                                                class="btn red btn-circle btn-icon-only btn-default">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </form>
                                </td>
                            </tr>
                        }
                        else if (item.NgayHetHan < DateTime.Now)
                        {
                            <tr class="item-1932 highlight" style="background-color:crimson;">
                                <td class="text-center">
                                    <div class="btn-group">
                                        <button class="btn btn-xs green dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false">
                                            Tác vụ
                                            <i class="fa fa-angle-down"></i>
                                        </button>
                                        <div class="dropdown">
                                            <ul class="dropdown-menu">
                                                <li>
                                                    <a href="#" onclick="ShowPopup('@Url.Action("AddOrEdit","DatPhong",new { id = item.MaDP }, Context.Request.Scheme)','Chỉnh sửa')"><i class="fas fa-edit"></i> Chỉnh sửa</a>
                                                </li>
                                                <li>
                                                    <a href="#" onclick="ShowPopupLarge('@Url.Action("AddOrEdit","HopDong",new { id = 0, idDatPhong = item.MaDP }, Context.Request.Scheme)','Nhận phòng')"><i class="fas fa-handshake-o" aria-hidden="true"></i>Nhận phòng</a>
                                                </li>
                                                <li class="divider"></li>
                                                <li>
                                                    <a asp-controller="DatPhong" asp-action="ExportPDF" asp-route-id="@item.MaDP"><i class="fas fa-handshake-o" aria-hidden="true"></i>Giay nhận cọc</a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </td>
                                <td>@item.TenPhong</td>
                                <td>@item.TenKhachHang</td>
                                <td>@item.SoDienThoai</td>
                                <td>@item.SoTienCoc</td>
                                <td>@item.NgayDat</td>
                                <td>@item.NgayHetHan</td>
                                <td class="text-center">
                                    <form asp-action="Delete"
                                          asp-route-id="@item.MaDP"
                                          onsubmit="return jQueryAjaxDelete(this)">
                                        <button type="submit"
                                                class="btn red btn-circle btn-icon-only btn-default">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </form>
                                </td>
                            </tr>
                        }
                        else
                        {
                            <tr class="item-1932 highlight">
                                <td class="text-center">
                                    <div class="btn-group">
                                        <button class="btn btn-xs green dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false">
                                            Tác vụ
                                            <i class="fa fa-angle-down"></i>
                                        </button>
                                        <div class="dropdown">
                                            <ul class="dropdown-menu">
                                                <li>
                                                    <a onclick="ShowPopup('@Url.Action("AddOrEdit","DatPhong",new { id = item.MaDP }, Context.Request.Scheme)','Chỉnh sửa')"><i class="fas fa-edit"></i> Chỉnh sửa</a>
                                                </li>
                                                <li>
                                                    <a onclick="ShowPopupLarge('@Url.Action("AddOrEdit","HopDong",new { id = 0, idDatPhong = item.MaDP }, Context.Request.Scheme)','Nhận phòng')"><i class="fas fa-handshake-o" aria-hidden="true"></i>Nhận phòng</a>
                                                </li>
                                                <li>
                                                    <a id="btn_nhangiaycoc" asp-controller="DatPhong" asp-action="ExportPDF" asp-route-id="@item.MaDP"><i class="fas fa-handshake-o" aria-hidden="true"></i>Giay nhận cọc</a>
                                                    <a onclick="jQueryAjaxExportPDF('@Url.Action("ExportPDF","DatPhong",new { id = item.MaDP }, Context.Request.Scheme)')"><i class="fas fa-handshake-o" aria-hidden="true"></i>Nhận phòng</a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </td>
                                <td>@item.TenPhong</td>
                                <td>@item.TenKhachHang</td>
                                <td>@item.SoDienThoai</td>
                                <td>@item.SoTienCoc</td>
                                <td>@item.NgayDat</td>
                                <td>@item.NgayHetHan</td>
                                <td class="text-center">
                                    <form asp-action="Delete"
                                          asp-route-id="@item.MaDP"
                                          onsubmit="return jQueryAjaxDelete(this)">
                                        <button type="submit"
                                                class="btn red btn-circle btn-icon-only btn-default">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </form>
                                </td>
                            </tr>
                        }

                    }
                }
            </tbody>
        </table>
    </div>
</div>


<script>
    $(document).ready(function () {
        $('#btn_nhangiaycoc').click(function () {
            $.ajax({
                type: "GET",
                url: '/DatPhong/ExportPDF',
                dataType: 'script',
                data: {
                    id: $('#txt_maDP').val(),
                }

            });
        });
    });
    $('#GetPDF').click(function (e) {
        window.open('@Url.Action("ShowPDF", "Controller")');
    });
</script>

